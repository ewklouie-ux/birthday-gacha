<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Birthday Gacha</title>

<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: radial-gradient(circle at top, #1c1c2b, #0d0d16);
    color: white;
    text-align: center;
    overflow: hidden;
  }

  button {
    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
    border: none;
    border-radius: 14px;
    padding: 14px 24px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 12px;
  }

  #banner {
    font-size: 28px;
    margin-top: 24px;
  }

  #level-container {
    width: 80%;
    max-width: 420px;
    margin: 14px auto 6px;
  }

  #level-text {
    font-size: 14px;
    margin-bottom: 6px;
    opacity: 0.85;
  }

  #level-bar {
    height: 10px;
    background: rgba(255,255,255,0.15);
    border-radius: 8px;
    overflow: hidden;
  }

  #level-fill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #ffd86f, #ff9f43);
    transition: width 0.4s ease;
  }

  #card {
    margin: 30px auto;
    width: 260px;
    height: 160px;
    border-radius: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    background: rgba(255,255,255,0.1);
    box-shadow: 0 0 20px rgba(0,0,0,0.4);
    transition: transform 0.25s ease, box-shadow 0.25s ease;
  }

  .common { border: 2px solid #bbb; }
  .rare { border: 2px solid #4da6ff; }
  .epic { border: 2px solid #c77dff; box-shadow: 0 0 18px #c77dff88; }
  .legendary {
    border: 2px solid #ffd86f;
    box-shadow: 0 0 28px #ffd86f;
    animation: pulse 1.2s infinite;
  }

  @keyframes pulse {
    0% { box-shadow: 0 0 20px #ffd86f; }
    50% { box-shadow: 0 0 36px #ffd86f; }
    100% { box-shadow: 0 0 20px #ffd86f; }
  }

  #level-up {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(135deg, #ffd86f, #ff9f43);
    color: black;
    padding: 10px 18px;
    border-radius: 14px;
    font-weight: bold;
    display: none;
    z-index: 50;
  }

  #controls {
    margin-top: 12px;
  }
</style>
</head>

<body>

<div id="banner">ðŸŽ‚ Limited Birthday Banner ðŸŽ‚</div>

<div id="level-container">
  <div id="level-text">Level 1 â€” 0 / 100 XP</div>
  <div id="level-bar">
    <div id="level-fill"></div>
  </div>
</div>

<div id="card">Tap Roll âœ¨</div>

<div id="controls">
  <button onclick="roll()">Roll</button>
</div>

<div id="level-up">LEVEL UP!</div>

<script>
  // ===============================
  // STATE
  // ===============================
  let totalXP = 0;
  let currentLevel = 1;

  const levelThresholds = [0, 100, 250, 500, 900, 1400, 2000];

  const card = document.getElementById("card");
  const levelText = document.getElementById("level-text");
  const levelFill = document.getElementById("level-fill");
  const levelUpToast = document.getElementById("level-up");

  // ===============================
  // RNG
  // ===============================
  function roll() {
    const r = Math.random();
    let rarity, text, xp = 0;

    if (r < 0.6) {
      rarity = "common";
      xp = 10;
      text = `Common\n+${xp} XP`;
    } else if (r < 0.85) {
      rarity = "rare";
      xp = 25;
      text = `Rare\n+${xp} XP`;
    } else if (r < 0.97) {
      rarity = "epic";
      xp = 60;
      text = `Epic\n+${xp} XP\nðŸ’œ Reward`;
    } else {
      rarity = "legendary";
      xp = 120;
      text = `LEGENDARY\n+${xp} XP\nðŸŒŸ Reward`;
    }

    applyCard(rarity, text);
    gainXP(xp);
  }

  // ===============================
  // UI HELPERS
  // ===============================
  function applyCard(rarity, text) {
    card.className = rarity;
    card.textContent = text;
    card.style.transform = "scale(1.05)";
    setTimeout(() => card.style.transform = "scale(1)", 180);
  }

  function gainXP(amount) {
    totalXP += amount;

    let nextLevel = currentLevel;
    while (
      nextLevel + 1 < levelThresholds.length &&
      totalXP >= levelThresholds[nextLevel]
    ) {
      nextLevel++;
    }

    if (nextLevel > currentLevel) {
      currentLevel = nextLevel;
      showLevelUp();
    }

    updateLevelUI();
  }

  function updateLevelUI() {
    const curr = levelThresholds[currentLevel - 1];
    const next = levelThresholds[currentLevel] ?? curr + 300;
    const progress = Math.min(
      (totalXP - curr) / (next - curr),
      1
    );

    levelText.textContent =
      `Level ${currentLevel} â€” ${totalXP - curr} / ${next - curr} XP`;

    levelFill.style.width = `${progress * 100}%`;
  }

  function showLevelUp() {
    levelUpToast.style.display = "block";
    setTimeout(() => {
      levelUpToast.style.display = "none";
    }, 1400);
  }
</script>

</body>
</html>
