<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#4f46e5">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<title>Birthday Limited Banner</title>

<style>
body {
  margin: 0;
  background: radial-gradient(circle at top, #111433, #0b0d1a);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

#app {
  width: 100%;
  max-width: 420px;
  padding: 20px;
  text-align: center;
  transition: opacity 0.4s ease, filter 0.4s ease;
}

.locked {
  opacity: 0.12;
  filter: blur(6px);
  pointer-events: none;
}

/* XP + LEVEL */
#xpContainer {
  margin: 12px 0 8px;
  background: #12142a;
  border-radius: 999px;
  padding: 4px;
}

#xpBar {
  height: 14px;
  width: 0%;
  border-radius: 999px;
  background: linear-gradient(
    90deg,
    #38bdf8,
    #6366f1,
    #a855f7,
    #ec4899
  );
  transition: width 0.35s ease;
}

#xpMeta {
  display: flex;
  justify-content: space-between;
  font-size: 0.75rem;
  opacity: 0.8;
  margin-bottom: 6px;
}

/* LEVEL UP OVERLAY */
#levelUpOverlay {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 6000;
  background: radial-gradient(circle, rgba(168,85,247,0.4), rgba(0,0,0,0.95));
  backdrop-filter: blur(6px);
  justify-content: center;
  align-items: center;
  text-align: center;
  animation: fadeIn 0.3s ease forwards;
}

#levelUpBox {
  animation: pop 0.6s ease forwards;
}

@keyframes pop {
  0% { transform: scale(0.7); opacity: 0; }
  60% { transform: scale(1.1); opacity: 1; }
  100% { transform: scale(1); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* RESULTS */
#result {
  min-height: 120px;
  max-height: 45vh;
  overflow-y: auto;
}

.card {
  margin: 6px 0;
  padding: 12px;
  border-radius: 14px;
  background: #1a1d33;
}

.Common { border-left: 6px solid #b0b0b0; }
.Rare { border-left: 6px solid #4da6ff; }
.Epic { border-left: 6px solid #b066ff; }
.Legendary { border-left: 6px solid gold; }

button {
  width: 100%;
  padding: 14px;
  font-size: 1.1rem;
  border-radius: 14px;
  border: none;
  background: #4f46e5;
  color: white;
  cursor: pointer;
  margin-top: 10px;
}

button:disabled {
  opacity: 0.5;
}

/* LEGENDARY */
#legendaryOverlay {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 5000;
  background: radial-gradient(circle, rgba(255,215,0,0.35), rgba(0,0,0,0.95));
  backdrop-filter: blur(6px);
  justify-content: center;
  align-items: center;
  text-align: center;
}
</style>
</head>

<body>

<div id="levelUpOverlay">
  <div id="levelUpBox">
    <h1>ðŸŽ‰ LEVEL UP ðŸŽ‰</h1>
    <p id="levelUpText"></p>
  </div>
</div>

<div id="app">
  <h1>ðŸŽ‚ Limited Birthday Banner</h1>

  <div id="xpMeta">
    <span id="levelText">Level 1</span>
    <span id="xpText">0 / 1000 XP</span>
  </div>

  <div id="xpContainer">
    <div id="xpBar"></div>
  </div>

  <div id="result"></div>
  <button id="rollBtn">ðŸŽ² Roll 10</button>
</div>

<div id="legendaryOverlay">
  <div>
    <h1>ðŸŒŸ LEGENDARY ðŸŒŸ</h1>
    <p id="legendaryPrize"></p>
    <button id="ackLegendary">Accept Gift</button>
  </div>
</div>

<script>
let isRolling = false;

/* XP CONFIG */
const XP_PER_BAR = 1000;
const XP_KEY = "birthday_total_xp";

let lastLevel = null;

const xpBar = document.getElementById("xpBar");
const xpText = document.getElementById("xpText");
const levelText = document.getElementById("levelText");

const levelUpOverlay = document.getElementById("levelUpOverlay");
const levelUpText = document.getElementById("levelUpText");

const rollBtn = document.getElementById("rollBtn");
const resultDiv = document.getElementById("result");

const legendaryOverlay = document.getElementById("legendaryOverlay");
const legendaryPrize = document.getElementById("legendaryPrize");
const ackLegendary = document.getElementById("ackLegendary");

/* XP */
function getTotalXP() {
  return JSON.parse(localStorage.getItem(XP_KEY)) || 0;
}
function addXP(amount) {
  const next = getTotalXP() + amount;
  localStorage.setItem(XP_KEY, JSON.stringify(next));
  return next;
}
function getLevel(xp) {
  return Math.floor(xp / XP_PER_BAR) + 1;
}

function showLevelUp(level) {
  levelUpText.textContent = `You reached Level ${level}`;
  levelUpOverlay.style.display = "flex";
  setTimeout(() => {
    levelUpOverlay.style.display = "none";
  }, 1400);
}

function updateXPUI() {
  const totalXP = getTotalXP();
  const currentXP = totalXP % XP_PER_BAR;
  const percent = (currentXP / XP_PER_BAR) * 100;
  const level = getLevel(totalXP);

  xpBar.style.width = `${percent}%`;
  xpText.textContent = `${currentXP} / ${XP_PER_BAR} XP`;
  levelText.textContent = `Level ${level}`;

  if (lastLevel !== null && level > lastLevel) {
    showLevelUp(level);
  }
  lastLevel = level;
}

/* ROLL */
const xpValues = { Common:10, Rare:25, Epic:60, Legendary:120 };
const rarities = ["Common","Rare","Epic","Legendary"];

rollBtn.onclick = async () => {
  isRolling = true;
  rollBtn.disabled = true;
  resultDiv.innerHTML = "";

  for (let i = 0; i < 10; i++) {
    await new Promise(r => setTimeout(r, 250));
    const rarity = rarities[Math.floor(Math.random()*rarities.length)];
    const xp = xpValues[rarity];

    addXP(xp);
    updateXPUI();

    const card = document.createElement("div");
    card.className = `card ${rarity}`;
    card.innerHTML = `<strong>${rarity}</strong><br>+${xp} XP`;
    resultDiv.appendChild(card);
  }

  rollBtn.disabled = false;
  isRolling = false;
};

updateXPUI();
</script>
</body>
</html>
