<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Birthday Banner</title>
<style>
body { font-family: sans-serif; background: #111; color: #fff; text-align:center; }
#rollButton { padding:10px 20px; font-size:18px; margin:20px; cursor:pointer; }
.roll-container { display:flex; justify-content:center; flex-wrap:wrap; margin:20px; }
.roll-card { width:80px; height:100px; margin:5px; display:flex; align-items:center; justify-content:center; border-radius:10px; background:#222; font-weight:bold; font-size:18px; transition: transform 0.2s;}
.roll-card.common { border:2px solid #888; }
.roll-card.rare { border:2px solid #1e90ff; }
.roll-card.epic { border:2px solid #a020f0; }
.roll-card.legendary { border:2px solid #ffd700; animation: glow 1s infinite alternate; }
@keyframes glow { 0% { box-shadow: 0 0 5px #ffd700; } 100% { box-shadow: 0 0 20px #ffd700; } }
#history { max-height:300px; overflow-y:auto; margin-top:20px; text-align:left; padding:0 20px; border-top:1px solid #444;}
</style>
</head>
<body>

<h1>Birthday Banner</h1>
<button id="rollButton">Roll 10x</button>
<div class="roll-container" id="rollContainer"></div>
<div id="history"></div>

<script>
let rollCount = 0;
let pityCounter = 0;
const hardPity = 50; // guaranteed Legendary if not hit by 50th roll
const rollContainer = document.getElementById('rollContainer');
const history = document.getElementById('history');

const pools = {
  common: ['1 kiss', 'hand-hold 2 min', 'compliment', 'photo together', 'sit closer'],
  rare: ['write a short note', 'choose next snack', 'extended cuddle', '5-min photo session'],
  epic: ['prepared mini gift', '10-min massage', 'surprise drink', 'scenic stop'],
  legendary: ['main birthday gift', 'deep handwritten letter']
};

function getRandomFromPool(rarity) {
  const items = pools[rarity];
  return items[Math.floor(Math.random() * items.length)];
}

function rollOnce() {
  rollCount++;
  pityCounter++;
  let rarityRoll = Math.random() * 100;
  let rarity;

  if (pityCounter >= hardPity) rarityRoll = 100; // force Legendary

  if (rarityRoll <= 70) rarity = 'common';
  else if (rarityRoll <= 90) rarity = 'rare';
  else if (rarityRoll <= 99) rarity = 'epic';
  else rarity = 'legendary';

  if (rarity === 'legendary') pityCounter = 0; // reset pity

  const reward = getRandomFromPool(rarity);
  logRoll(rollCount, rarity, reward);
  return {rarity, reward};
}

function logRoll(count, rarity, reward) {
  const entry = document.createElement('div');
  entry.textContent = `Roll ${count}: ${rarity.toUpperCase()} â†’ ${reward}`;
  history.appendChild(entry);
  history.scrollTop = history.scrollHeight;
}

function animateRolls(times) {
  rollContainer.innerHTML = '';
  let i = 0;
  const interval = setInterval(() => {
    if (i >= times) {
      clearInterval(interval);
      return;
    }
    const result = rollOnce();
    const card = document.createElement('div');
    card.className = 'roll-card ' + result.rarity;
    card.textContent = result.rarity.toUpperCase();
    rollContainer.appendChild(card);
    i++;
  }, 250);
}

document.getElementById('rollButton').addEventListener('click', () => animateRolls(10));
</script>

</body>
</html>
