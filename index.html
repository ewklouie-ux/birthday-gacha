<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Birthday Banner ðŸŽ‚</title>

  <style>
    body {
      margin: 0;
      padding: 0;
      background: #0f1220;
      color: white;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    h1 {
      margin-top: 24px;
      font-size: 1.4rem;
      opacity: 0.9;
    }

    button {
      margin: 16px;
      padding: 14px 28px;
      font-size: 1.1rem;
      border-radius: 12px;
      border: none;
      background: linear-gradient(135deg, #7f5cff, #4b7bff);
      color: white;
      cursor: pointer;
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    #results {
      width: 90%;
      max-width: 420px;
      margin-bottom: 40px;
    }

    .card {
      margin: 10px 0;
      padding: 14px;
      border-radius: 14px;
      background: #1a1d33;
      box-shadow: 0 6px 14px rgba(0,0,0,0.4);
      transform: translateY(20px);
      opacity: 0;
      animation: reveal 0.4s ease forwards;
    }

    @keyframes reveal {
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .rarity {
      font-size: 0.9rem;
      letter-spacing: 1px;
      opacity: 0.85;
    }

    .prize {
      margin-top: 6px;
      font-size: 1.05rem;
      font-weight: 500;
    }

    /* RARITY COLORS */
    .Common { border-left: 6px solid #b0b0b0; }
    .Rare { border-left: 6px solid #4da6ff; }
    .Epic { border-left: 6px solid #b066ff; }
    .Legendary {
      border-left: 6px solid gold;
      background: linear-gradient(135deg, #2a1f00, #1a1d33);
    }
  </style>
</head>

<body>
  <h1>Birthday Banner ðŸŽ‚</h1>
  <button id="rollBtn">Roll x10</button>

  <div id="results"></div>

  <script>
    const rollBtn = document.getElementById("rollBtn");
    const resultsDiv = document.getElementById("results");

    const pool = {
      Common: ["Hug Coupon", "Movie Pick", "Snack Date"],
      Rare: ["Dinner Date", "Playlist Made For You"],
      Epic: ["Full Day Together", "Custom Gift"],
      Legendary: ["Surprise Trip ðŸ’›"]
    };

    /* =========================
       LOGGING + COUNTERS
       ========================= */

    function getRollCount() {
      return parseInt(localStorage.getItem("totalRolls") || "0");
    }

    function incrementRollCount() {
      const newCount = getRollCount() + 1;
      localStorage.setItem("totalRolls", newCount);
      return newCount;
    }

    function getRollLog() {
      return JSON.parse(localStorage.getItem("rollLog") || "[]");
    }

    function logRoll(entry) {
      const log = getRollLog();
      log.push(entry);
      localStorage.setItem("rollLog", JSON.stringify(log));
    }

    /* =========================
       RNG CORE
       ========================= */

    function rollRarity() {
      const r = Math.random();
      if (r < 0.6) return "Common";
      if (r < 0.85) return "Rare";
      if (r < 0.97) return "Epic";
      return "Legendary";
    }

    function randomFrom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    /* =========================
       ROLL x10 FLOW
       ========================= */

    async function rollTen() {
      rollBtn.disabled = true;
      resultsDiv.innerHTML = "";

      for (let i = 0; i < 10; i++) {
        const rarity = rollRarity();
        const prize = randomFrom(pool[rarity]);
        const rollNumber = incrementRollCount();

        // LOG ROLL
        logRoll({
          rollNumber,
          rarity,
          prize,
          timestamp: new Date().toISOString()
        });

        // UI CARD
        const card = document.createElement("div");
        card.className = `card ${rarity}`;

        card.innerHTML = `
          <div class="rarity">
            ${"â˜…".repeat(
              rarity === "Common" ? 1 :
              rarity === "Rare" ? 2 :
              rarity === "Epic" ? 4 : 5
            )} ${rarity.toUpperCase()}
          </div>
          <div class="prize">${prize}</div>
        `;

        resultsDiv.appendChild(card);
        await new Promise(res => setTimeout(res, 300));
      }

      rollBtn.disabled = false;
    }

    rollBtn.addEventListener("click", rollTen);
  </script>
</body>
</html>
